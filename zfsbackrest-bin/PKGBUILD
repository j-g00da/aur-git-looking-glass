# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: SphericalKat <contact@kat.bio>
# Maintainer: Akshit Garg <zfsbackrest@akshit.network>

pkgname='zfsbackrest-bin'
pkgver=0.2.0
pkgrel=5
pkgdesc='ZFS Backup and Restore Tool'
url='https://github.com/gargakshit/zfsbackrest'
arch=('aarch64' 'x86_64')
license=('MIT')
provides=('zfsbackrest')
conflicts=('zfsbackrest')
depends=('zfs-utils' 'libunwind')
optdepends=('age: for generating encryption keys')
backup=('etc/zfsbackrest.toml')
install=zfsbackrest.install

source_aarch64=("${pkgname}_${pkgver}_aarch64.tar.gz::https://github.com/gargakshit/zfsbackrest/releases/download/v0.2.0/zfsbackrest_Linux_arm64.tar.gz")
sha256sums_aarch64=('850ec657cc05d9d7852ac590dfc2279547975d11f96ef2c0ec2673c53f61b290')

source_x86_64=("${pkgname}_${pkgver}_x86_64.tar.gz::https://github.com/gargakshit/zfsbackrest/releases/download/v0.2.0/zfsbackrest_Linux_x86_64.tar.gz")
sha256sums_x86_64=('2d052e36491a973fc6bb5371b021fe7413c01dcc126fe5999c7313fa5d4d2d33')

package() {
  # bin
  install -Dm755 "./zfsbackrest" "${pkgdir}/usr/bin/zfsbackrest"

  # license/docs
  install -Dm644 "./LICENSE" "${pkgdir}/usr/share/licenses/zfsbackrest/LICENSE"

  mkdir -p "${pkgdir}/usr/share/doc/zfsbackrest"
  install -Dm644 "./README.md" "${pkgdir}/usr/share/doc/zfsbackrest/README"

  # config
  install -Dm644 "./zfsbackrest.example.toml" "${pkgdir}/etc/zfsbackrest.example.toml"

  # systemd
  install -Dm644 "./systemd/zfsbackrest-backup@.service" "${pkgdir}/etc/systemd/system/zfsbackrest-backup@.service"

  # completions
  mkdir -p "${pkgdir}/usr/share/bash-completion/completions/"
  mkdir -p "${pkgdir}/usr/share/zsh/site-functions/"
  mkdir -p "${pkgdir}/usr/share/fish/vendor_completions.d/"

  ./zfsbackrest completions bash > "${pkgdir}/usr/share/bash-completion/completions/zfsbackrest"
  ./zfsbackrest completions zsh > "${pkgdir}/usr/share/zsh/site-functions/_zfsbackrest"
  ./zfsbackrest completions fish > "${pkgdir}/usr/share/fish/vendor_completions.d/zfsbackrest.fish"

}
