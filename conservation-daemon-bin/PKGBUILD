# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: Marco Realacci <marco@marcorealacci.me>

pkgname='conservation-daemon-bin'
pkgver=0.1.0
pkgrel=1
pkgdesc='Battery conservation mode daemon for Lenovo Yoga/IdeaPad'
url='https://git.marcorealacci.me/marcorealacci/conservation-daemon'
arch=('x86_64')
license=('MIT')
provides=('conservation-daemon' 'conservationd' 'conservationctl')
conflicts=('conservation-daemon')
depends=('upower')
install=conservation-daemon.install

source_x86_64=("${pkgname}_${pkgver}_x86_64.tar.gz::https://git.marcorealacci.me/marcorealacci/conservation-daemon/releases/download/v0.1.0/conservation-daemon_0.1.0_linux_amd64.tar.gz")
sha256sums_x86_64=('386dda76a4a5f89b9d55ade0256fea8e232f292981435949145505be3fe72395')

package() {
  install -Dm755 "./conservationd" "${pkgdir}/usr/bin/conservationd"
  install -Dm755 "./conservationctl" "${pkgdir}/usr/bin/conservationctl"
  # Write systemd unit file
  install -d "${pkgdir}/usr/lib/systemd/system"
  printf '%s\n' \
  '[Unit]' \
  'Description=Battery Conservation Mode Daemon (Lenovo Yoga/IdeaPad)' \
  'After=network.target dbus.service upower.service' \
  'Wants=upower.service' \
  '' \
  '[Service]' \
  'Type=simple' \
  'ExecStart=/usr/bin/conservationd' \
  'Restart=on-failure' \
  'RestartSec=5s' \
  'RuntimeDirectory=conservationd' \
  'Group=conservationd' \
  'RuntimeDirectoryMode=0770' \
  '' \
  '[Install]' \
  'WantedBy=multi-user.target' \
  > "${pkgdir}/usr/lib/systemd/system/conservationd.service"
}
