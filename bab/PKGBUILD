# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: Sebastian Stepper <sebastian-stepper@gmx.de>

pkgname='bab'
pkgver=0.0.9
pkgrel=1
pkgdesc='A modern task runner from simple to scaled'
url='https://github.com/bab-sh/bab'
arch=('aarch64' 'x86_64')
license=('MIT')
provides=('bab')
conflicts=('bab-bin')
depends=('glibc')
makedepends=('go' 'git')
source=("${pkgname}_${pkgver}.tar.gz::https://github.com/bab-sh/bab/archive/refs/tags/v0.0.9.tar.gz")
sha256sums=('e798f72ca1c2ab5faee3b75d757043fee62d0973ff21ab4094967b2939ec4eb4')
build() {
  cd "${pkgname}-${pkgver}"
  export CGO_ENABLED=0
  export CGO_CPPFLAGS="${CPPFLAGS}"
  export CGO_CFLAGS="${CFLAGS}"
  export CGO_CXXFLAGS="${CXXFLAGS}"
  export CGO_LDFLAGS="${LDFLAGS}"
  export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"

  go build \
  -ldflags="-s -w -buildid='' -linkmode=external \
  -X github.com/bab-sh/bab/internal/version.Version=${pkgver} \
  -X github.com/bab-sh/bab/internal/version.Commit=f49167b49e2d1f6d05f1df2625a1fff0e2021d30 \
  -X github.com/bab-sh/bab/internal/version.Date=2025-10-13T17:14:21Z \
  -X github.com/bab-sh/bab/internal/version.BuiltBy=aur" \
  -o bab .

  # Generate shell completions
  mkdir -p completions
  ./bab completion bash > completions/bab.bash
  ./bab completion zsh > completions/bab.zsh
  ./bab completion fish > completions/bab.fish
}
package() {
  cd "${pkgname}-${pkgver}"

  # Binary
  install -Dm755 ./bab "${pkgdir}/usr/bin/bab"

  # Documentation
  install -Dm644 ./README.md "${pkgdir}/usr/share/doc/${pkgname}/README.md"
  install -Dm644 ./LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

  # Shell completions
  install -Dm644 ./completions/bab.bash "${pkgdir}/usr/share/bash-completion/completions/bab"
  install -Dm644 ./completions/bab.zsh "${pkgdir}/usr/share/zsh/site-functions/_bab"
  install -Dm644 ./completions/bab.fish "${pkgdir}/usr/share/fish/vendor_completions.d/bab.fish"
}
