# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: Fernandez Ludovic <lfernandez dot dev at gmail dot com>

pkgname='prm'
pkgver=3.6.4
pkgrel=2
pkgdesc='Pull Request Manager for Maintainers'
url='https://github.com/ldez/prm'
arch=('aarch64' 'x86_64')
license=('APACHE')
provides=('prm')
conflicts=('prm')
depends=('git')
makedepends=('go' 'git')
source=("${pkgname}_${pkgver}.tar.gz::https://github.com/ldez/prm/releases/download/v3.6.4/prm_v3.6.4_sources.tar.gz")
sha256sums=('849d0e6f7b3d351c35da610f06ec8f8767ccf13836880ba7630a3a87e490212e')

prepare() {
  go mod download
}

build() {
  export CGO_CPPFLAGS="${CPPFLAGS}"
  export CGO_CFLAGS="${CFLAGS}"
  export CGO_CXXFLAGS="${CXXFLAGS}"
  export CGO_LDFLAGS="${LDFLAGS}"
  export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"
  go build -ldflags="-w -s -buildid='' -linkmode=external -X main.version=v${pkgver}" .

  chmod +x "./${pkgname}"
}

package() {
  ls -alF

  # Bin
  install -Dsm755 "./${pkgname}" "${pkgdir}/usr/bin/${pkgname}"
}
