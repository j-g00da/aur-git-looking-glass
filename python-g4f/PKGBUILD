# PKGBUILD generated by pipman
# Python package author: Tekky <<support@g4f.ai>>
# Maintainer: Magi3r <magier dot mit dot f3erball at gmail dot com>
pkgname=python-g4f
_name=g4f
pkgver=0.5.0.4
pkgrel=1
pkgdesc='The official gpt4free repository | various collection of powerful language models'
arch=('any')
url=https://github.com/xtekky/gpt4free
license=('GPL3')
depends=('python-requests' 'python-pycryptodome' 'python-curl-cffi>=0.6.2'
         'python-aiohttp' 'python-certifi' 'python-browser-cookie3' 'python-pyexecjs' 'python-duckduckgo-search>=5.0'
         'python-nest-asyncio' 'python-werkzeug' 'python-loguru' 'python-pillow' 'python-platformdirs'
         'python-fastapi' 'uvicorn' 'python-flask' 'python-brotli' 'python-beautifulsoup4'
         'python-aiohttp-socks' 'python-pywebview' 'python-plyer' 'python-cryptography' 'python-nodriver')
makedepends=('python-build' 'python-installer' 'python-wheel')
source=("https://files.pythonhosted.org/packages/source/${_name::1}/$_name/$_name-$pkgver.tar.gz")
sha256sums=('b4538f8d8b7c9daaaead1564b8c3821ed5086bc6e36c0f9c63f2daa3b4c5245b')

build() {
    cd $_name-$pkgver
    python -m build --wheel --skip-dependency-check --no-isolation
}

check() {
    cd $_name-$pkgver
}

package() {
    cd $_name-$pkgver
    python -m installer --destdir="$pkgdir" dist/*.whl

    # Symlink license file
    local site_packages=$(python -c "import site; print(site.getsitepackages()[0])")
    install -d "$pkgdir"/usr/share/licenses/$pkgname
    ln -s "$site_packages"/$_name-$pkgver.dist-info/LICENSE \
       "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}
