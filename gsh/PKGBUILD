# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: atinylittleshell <shell@atinylittleshell.me>
# Maintainer: Vitalii Kuzhdin <vitaliikuzhdin@gmail.com>

pkgname='gsh'
pkgver=0.22.2
pkgrel=1
pkgdesc='A modern, POSIX-compatible, generative shell'
url='https://github.com/atinylittleshell/gsh'
arch=('aarch64' 'x86_64')
license=('GPL-3.0-or-later')
provides=('gsh')
conflicts=('gsh')
makedepends=('go' 'git')
source=("${pkgname}_${pkgver}.tar.gz::https://github.com/atinylittleshell/gsh/releases/download/v0.22.2/gsh-0.22.2.tar.gz")
sha256sums=('a3bb8abaac2bcdd50791745c08e127968337b6f5332acca2d19461dc8d7fd24a')
prepare() {
  cd "${srcdir}/${_pkgsrc}"
  go mod download
}
build() {
  cd "${srcdir}/${_pkgsrc}"
  export CGO_ENABLED=0
  export GOFLAGS="-trimpath -mod=readonly -modcacherw"
  go build -ldflags="-X main.BUILD_VERSION=${pkgver}" -o "./bin/${pkgname}" "./cmd/${pkgname}"
}
package() {
  cd "${srcdir}/${_pkgsrc}"

  # bin
  install -Dsm755 "./bin/${pkgname}" "${pkgdir}/usr/bin/${pkgname}"

  # license
  install -Dm644 "./LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

  # information
  install -Dm644 "./README.md" "${pkgdir}/usr/share/doc/${pkgname}/README.md"
  install -Dm644 "./ROADMAP.md" "${pkgdir}/usr/share/doc/${pkgname}/ROADMAP.md"
  install -Dm644 "./CHANGELOG.md" "${pkgdir}/usr/share/doc/${pkgname}/CHANGELOG.md"
}
