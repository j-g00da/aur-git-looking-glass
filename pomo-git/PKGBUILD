# Maintainer: Kevin Schoon <kevinschoon@pm.me>
_pkgname=pomo
pkgname=${_pkgname}-git
pkgver=r182.ce6a267
pkgrel=1
pkgdesc='Pomodoro Command Line Interface'
url='https://codeberg.org/kevinschoon/pomo'
arch=(x86_64 aarch64)
license=('MIT')
source=("$pkgname::git+https://codeberg.org/kevinschoon/pomo")
sha512sums=('SKIP')
makedepends=('git' 'go')
conflicts=('pomo')

pkgver() {
    cd ${pkgname}
    printf 'r%s.%s' "$(git rev-list --count HEAD)" \
			"$(git rev-parse --short HEAD)"
}

build() {
	cd "${pkgname}/cmd/${_pkgname}"
	go build -ldflags \
		"-X github.com/kevinschoon/pomo/pkg/internal.Version=${pkgver}" \
		-o ../../../pomo
}

package() {
	install -Dm755 pomo "${pkgdir}/usr/bin/pomo"
}
