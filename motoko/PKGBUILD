# This file was generated by GoReleaser. DO NOT EDIT.
# Maintainer: Fernandez Ludovic <lfernandez dot dev at gmail dot com>

pkgname='motoko'
pkgver=0.4.0
pkgrel=1
pkgdesc='Based on Go modules, update a dependency to a major version.'
url='https://github.com/ldez/motoko'
arch=('aarch64' 'x86_64')
license=('APACHE')
provides=('motoko')
conflicts=('motoko')
makedepends=('go' 'git')
source=("${pkgname}_${pkgver}.tar.gz::https://github.com/ldez/motoko/releases/download/v0.4.0/motoko-v0.4.0-source.tar.gz")
sha256sums=('053d92ec1180bfaf210b8652563810cdc4196a5befdccf28f3a260dc568436d7')
build() {
  export BUILD_DATE=$(date -u '+%Y-%m-%d_%I:%M:%S%p')

  export CGO_CPPFLAGS="${CPPFLAGS}"
  export CGO_CFLAGS="${CFLAGS}"
  export CGO_CXXFLAGS="${CXXFLAGS}"
  export CGO_LDFLAGS="${LDFLAGS}"
  export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"

  go build -ldflags="-w -s -linkmode=external -X 'main.version=v${pkgver}' -X 'main.date=${BUILD_DATE}'"

  chmod +x "./${pkgname}"
}
package() {
  # Bin
  install -Dsm755 "./${pkgname}" "${pkgdir}/usr/bin/${pkgname}"

  # License
  install -Dm644 "./LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
